<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>åŒ–å­¦ è©¦é¨“å¯¾ç­–</title>
<style>
Â  Â  body {
Â  Â  Â  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
Â  Â  Â  margin: 0;
Â  Â  Â  padding: 0.5rem;
Â  Â  Â  background: #f9f9f9;
Â  Â  Â  color: #333;
Â  Â  Â  font-size: 18px;
Â  Â  Â  line-height: 1.6;
Â  Â  }
Â  Â  h1 {
Â  Â  Â  text-align: center;
Â  Â  Â  font-size: 1.8rem;
Â  Â  Â  margin: 0.5rem 0 1rem;
Â  Â  }
Â  Â  .tag-btn, #nextBtn {
Â  Â  Â  display: block;
Â  Â  Â  width: 100%;
Â  Â  Â  padding: 1rem;
Â  Â  Â  margin: 0.4rem 0;
Â  Â  Â  border: 1px solid #ccc;
Â  Â  Â  border-radius: 6px;
Â  Â  Â  font-size: 1.1rem;
Â  Â  Â  background: #fff;
Â  Â  Â  text-align: center;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  .tag-btn:hover {
Â  Â  Â  background: #f0f0f0;
Â  Â  }
Â  Â  #question {
Â  Â  Â  margin: 0.8rem 0;
Â  Â  Â  font-size: 1.2rem;
Â  Â  Â  line-height: 1.6;
Â  Â  }
Â  Â  #options {
Â  Â  Â  list-style: none;
Â  Â  Â  padding: 0;
Â  Â  Â  margin: 0;
Â  Â  }
Â  Â  #options li {
Â  Â  Â  margin-bottom: 0.5rem;
Â  Â  }
Â  Â  #options button {
Â  Â  Â  width: 100%;
Â  Â  Â  padding: 1rem;
Â  Â  Â  font-size: 1.1rem;
Â  Â  Â  border: 1px solid #ccc;
Â  Â  Â  border-radius: 6px;
Â  Â  Â  background: #fff;
Â  Â  Â  text-align: left;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  #options button:disabled {
Â  Â  Â  opacity: 0.7;
Â  Â  Â  cursor: default;
Â  Â  }
Â  Â  #progress {
Â  Â  Â  font-size: 0.9rem;
Â  Â  Â  text-align: center;
Â  Â  Â  margin: 0.8rem 0;
Â  Â  }
Â  Â  #result h2 {
Â  Â  Â  text-align: center;
Â  Â  Â  margin-top: 1.5rem;
Â  Â  }
Â  Â Â 
Â  Â  /* ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ï¼ˆãƒã‚¹ã‚¯ï¼‰ */
Â  Â  #overlay {
Â  Â  Â  position: fixed; /* ç”»é¢ã«å›ºå®š */
Â  Â  Â  top: 0;
Â  Â  Â  left: 0;
Â  Â  Â  width: 100%;
Â  Â  Â  height: 100%;
Â  Â  Â  background-color: rgba(0, 0, 0, 0.5); /* åŠé€æ˜ã®é»’ */
Â  Â  Â  display: none; /* é€šå¸¸ã¯éè¡¨ç¤º */
Â  Â  Â  z-index: 10;
Â  Â  Â  /* ç¸¦æ¨ªä¸­å¤®æƒãˆ */
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  }

Â  Â  /* ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—æœ¬ä½“ï¼‰ */
Â  Â  #modal {
Â  Â  Â  background: #fff;
Â  Â  Â  padding: 1.5rem;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  width: 85%; /* ã‚¹ãƒãƒ›ç”»é¢ã®85% */
Â  Â  Â  max-width: 400px; /* PCã§ã‚‚åºƒãŒã‚Šã™ããªã„ã‚ˆã†ã« */
Â  Â  Â  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
Â  Â  }
Â  Â  #modal-explanation {
Â  Â  Â  font-size: 0.95rem;
Â  Â  Â  color: #333;
Â  Â  Â  margin-top: 1rem;
Â  Â  Â  border-top: 1px solid #eee;
Â  Â  Â  padding-top: 1rem;
Â  Â  }
Â  Â  /* ãƒ¢ãƒ¼ãƒ€ãƒ«å†…ã®ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ */
Â  Â  #modalNextBtn {
Â  Â  Â  display: block;
Â  Â  Â  width: 100%;
Â  Â  Â  padding: 1rem;
Â  Â  Â  margin-top: 1.5rem;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 6px;
Â  Â  Â  font-size: 1.1rem;
Â  Â  Â  background: #0078d7;
Â  Â  Â  color: #fff;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  #modalNextBtn:hover {
Â  Â  Â  background: #005a9e;
Â  Â  }
</style>
</head>
<body>

Â  Â  <h1 id="mainTitle">åŒ–å­¦ è©¦é¨“å¯¾ç­–</h1>

Â  <div id="controls">
Â  Â  Â  Â  Â  Â  <button class="tag-btn" data-tag="chemistry">åŒ–å­¦ (2å­¦æœŸæœ«)</button>
Â  Â  Â  Â  Â  Â  <button class="tag-btn" data-tag="chem_basics">åŒ–å­¦åŸºç¤ (å¤§å­¦å…¥è©¦)</button>
Â  </div>

Â  <div id="quiz" style="display:none;">
Â  Â  <div id="question"></div>
Â  Â  <ul id="options"></ul>
Â  Â  <div id="progress"></div>
Â  </div>

Â  <div id="result" style="display:none;"></div>


Â  <div id="overlay">
Â  Â  <div id="modal">
Â  Â  Â  <div id="modal-message"></div>
Â  Â  Â  <div id="modal-explanation"></div>
Â  Â  Â  <button id="modalNextBtn">æ¬¡ã¸ â–¶</button>
Â  Â  </div>
Â  </div>


<script>
Â  let questions=[],current=0,score=0;

Â  // DOMãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã‚‰ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â Â 
Â  Â  document.querySelectorAll('.tag-btn').forEach(btn=>{
Â  Â  Â  // ã‚¯ãƒªãƒƒã‚¯ã§startQuizã‚’å‘¼ã³å‡ºã™
Â  Â  Â  btn.onclick=()=>startQuiz(btn.dataset.tag);
Â  Â  });

Â  Â  // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã®å‡¦ç†
Â  Â  document.getElementById('modalNextBtn').onclick = () => {
Â  Â  Â  document.getElementById('overlay').style.display = 'none'; // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
Â  Â  Â Â 
Â  Â  Â  // æ¬¡ã®å•é¡Œã¸é€²ã‚€
Â  Â  Â  if (++current < questions.length) {
Â  Â  Â  Â  showQuestion();
Â  Â  Â  } else {
Â  Â  Â  Â  showResults();
Â  Â  Â  }
Â  Â  };
Â  });


Â  /* CSVãƒ‘ãƒ¼ã‚µãƒ¼ (å¤‰æ›´ãªã—) */
Â  async function loadCSV(file){
Â  Â  const text = await (await fetch(file)).text();
Â  Â  const parseCsvLine = (line) => {
Â  Â  Â  const result = [];
Â  Â  Â  let currentField = '';
Â  Â  Â  let inQuote = false;
Â  Â  Â  for (let i = 0; i < line.length; i++) {
Â  Â  Â  Â  const char = line[i];
Â  Â  Â  Â  if (char === '"') {
Â  Â  Â  Â  Â  if (inQuote && line[i + 1] === '"') {
Â  Â  Â  Â  Â  Â  currentField += '"';
Â  Â  Â  Â  Â  Â  i++;
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  inQuote = !inQuote;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } else if (char === ',' && !inQuote) {
Â  Â  Â  Â  Â  result.push(currentField);
Â  Â  Â  Â  Â  currentField = '';
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  currentField += char;
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  Â  result.push(currentField);
Â  Â  Â  return result.map(field => {
Â  Â  Â  Â  if (field.startsWith('"') && field.endsWith('"')) {
Â  Â  Â  Â  Â  return field.substring(1, field.length - 1).replace(/""/g, '"');
Â  Â  Â  Â  }
Â  Â  Â  Â  return field;
Â  Â  Â  });
Â  Â  };
Â  Â  return text.trim().split(/\r?\n/).slice(1).map(line => {
Â  Â  Â  if (!line) return null;
Â  Â  Â  const c = parseCsvLine(line);
Â  Â  Â  if (c.length < 5) return null;Â 
Â  Â  Â  const lastIdx = c.length - 1;
Â  Â  Â  const answerIdx = lastIdx - 1;
Â  Â  Â  return {
Â  Â  Â  Â  q: c[1],
Â  Â  Â  Â  options: c.slice(2, answerIdx),
Â  Â  Â  Â  answer: +c[answerIdx] - 1,
Â  Â  Â  Â  explanation: c[lastIdx]
Â  Â  Â  };
Â  Â  }).filter(q => q !== null);
Â  }

Â  /* shuffle (å¤‰æ›´ãªã—) */
Â  function shuffle(a){
Â  Â  for(let i=a.length-1;i>0;i--){
Â  Â  Â  const j=Math.floor(Math.random()*(i+1));
Â  Â  Â  [a[i],a[j]]=[a[j],a[i]];
Â  Â  }
Â  Â  return a;
Â  }

Â  /* csvFileName (èª­ã¿è¾¼ã‚€CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®š) */
Â  function csvFileName(tag){
Â  Â  return {
Â  Â  Â  Â  Â  Â  chemistry: 'chemistry.csv',
Â  Â  Â  chem_basics: 'chemistry_basics.csv' 
Â  Â  }[tag];
Â  }

Â  /* startQuiz (å…¨å•å‡ºé¡Œ) */
Â  async function startQuiz(tag){
Â  Â  document.getElementById('controls').style.display='none';
Â  Â  document.getElementById('mainTitle').style.display='none';Â 
Â  Â Â 
Â  Â  const fileName = csvFileName(tag); // ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—
Â  Â  let pool;
Â  Â  try {
Â  Â  Â  pool = await loadCSV(fileName); // å–å¾—ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«åã‚’èª­ã¿è¾¼ã‚€
Â  Â  } catch(err) {
Â  Â  Â  console.error("CSV Load Error:", err);
Â  Â  Â  pool = [];Â 
Â  Â  }

Â  Â  if (!pool || pool.length === 0) {
Â  Â  Â  Â  // â–¼ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‹•çš„ã«å¤‰æ›´ â–¼
Â  Â  Â  Â  alert(`å•é¡Œãƒ•ã‚¡ã‚¤ãƒ«(${fileName})ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ•ã‚¡ã‚¤ãƒ«ãŒåŒã˜éšå±¤ã«ã‚ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚`);
Â  Â  Â  Â  document.getElementById('controls').style.display='';Â 
Â  Â  Â  Â  document.getElementById('mainTitle').style.display='block';
Â  Â  Â  Â  return;
Â  Â  }

Â  Â  // å…¨å•(pool.length)ã‚’å–å¾—
Â  Â  questions=shuffle(pool).slice(0,pool.length);Â Â 
Â  Â  current=score=0;
Â  Â  document.getElementById('result').style.display='none';
Â  Â  document.getElementById('quiz').style.display='';
Â  Â  showQuestion();
Â  }

Â  /**
Â  Â * showQuestion (innerHTML ã‚’ä½¿ç”¨)
Â  Â */
Â  function showQuestion(){
Â  Â  const q=questions[current];
Â  Â  document.getElementById('question').innerHTML = q.q; // â† innerHTMLã§ã‚¿ã‚°ã‚’è§£é‡ˆ
Â  Â  const ul=document.getElementById('options'); ul.innerHTML='';
Â  Â  q.options.forEach((opt,i)=>{
Â  Â  Â  const li=document.createElement('li');
Â  Â  Â  li.innerHTML=`<button>${opt}</button>`; // â† innerHTMLã§ã‚¿ã‚°ã‚’è§£é‡ˆ
Â  Â  Â  li.firstChild.onclick=()=>selectAnswer(i);
Â  Â  Â  ul.appendChild(li);
Â  Â  });
Â  Â  document.getElementById('progress').textContent=`${current+1}/${questions.length}`;
Â  }


Â  /* selectAnswer (innerHTML ã‚’ä½¿ç”¨) */
Â  function selectAnswer(idx){
Â  Â  const q=questions[current],ul=document.getElementById('options');
Â  Â Â 
Â  Â  // é¸æŠè‚¢ã®ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–ï¼†è‰²ä»˜ã‘
Â  Â  [...ul.children].forEach((li,i)=>{
Â  Â  Â  const b=li.firstChild; b.disabled=true;
Â  Â  Â  if(i===q.answer)b.style.background='lightgreen';
Â  Â  Â  else if(i===idx)b.style.background='salmon';Â 
Â  Â  });

Â  Â  // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ä¸­èº«ã‚’ä½œæˆ
Â  Â  let msgHtml = '';
Â  Â  if (idx === q.answer) {
Â  Â  Â  score++;
Â  Â  Â  msgHtml = '<span style="color:green; font-weight: bold;">ğŸŸ¢ æ­£è§£ï¼</span>';
Â  Â  } else {
Â  Â  Â  msgHtml = `<span style="color:red; font-weight: bold;">âŒ ä¸æ­£è§£</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â <br><span style="color:#555">æ­£è§£: ${q.options[q.answer]}</span>`; // æ­£è§£é¸æŠè‚¢ã‚‚innerHTMLã§è§£é‡ˆ
Â  Â  }

Â  Â  // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®è¦ç´ ã‚’å–å¾—ã—ã¦ä¸­èº«ã‚’ã‚»ãƒƒãƒˆ
Â  Â  document.getElementById('modal-message').innerHTML = msgHtml; // â† innerHTMLã§ã‚¿ã‚°ã‚’è§£é‡ˆ
Â  Â  document.getElementById('modal-explanation').innerHTML = "<b>è§£èª¬:</b> " + q.explanation; // â† innerHTMLã§ã‚¿ã‚°ã‚’è§£é‡ˆ
Â  Â Â 
Â  Â  // ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰ã‚’è¡¨ç¤º
Â  Â  document.getElementById('overlay').style.display = 'flex';
Â  }


Â  /* showResults (å¤‰æ›´ãªã—) */
Â  function showResults(){
Â  Ddocument.getElementById('quiz').style.display='none';
Â  Â  const r=document.getElementById('result');
Â  Â  r.innerHTML=`<h2>çµæœ: ${score}/${questions.length}</h2>`;
Â  Â  r.style.display='';
Â  Â  document.getElementById('controls').style.display='';
Â  Â  document.getElementById('mainTitle').style.display='block';
Â  }
</script>
</body>
</html>
